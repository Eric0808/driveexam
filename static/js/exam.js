function _submit(){this.items=show.render.topiclist.getElementsByTagName("A"),this.submiturl="exam/submit/"+examid+"/",this.checkNone=function(){var a,b,c=0;for(a in this.items)null!=this.items[a]&&"object"==typeof this.items[a]&&(b=this.items[a].getAttribute("data-id"),(null==topic.data[b]||null==topic.data[b].firstSelected)&&(show.addClass("error",this.items[a]),c++));return{all:this.items.length,none:c}},this.getValue=function(){var a,b,c,d=[];for(a in this.items)null!=this.items[a]&&"object"==typeof this.items[a]&&(b=this.items[a].getAttribute("data-id"),b&&(c=null!=topic.data[b]&&null!=topic.data[b].firstSelected?topic.data[b].firstSelected:"",d.push([b,c])));return d},this.send=function(a){var b,c,d="";for(b in a)a[b][0]&&(d+=a[b][0]+"="+a[b][1]+"&");c=new XMLHttpRequest,c.open("POST",base_url+this.submiturl),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.onreadystatechange=function(){if(message.hide(500),4===c.readyState)try{var a=JSON.parse(c.responseText);"object"==typeof a&&message.show(a.msg+" 正在跳转到成绩详情页面",3e3),0==a.code&&(window.location.href=base_url+"scores/detail/"+examid)}catch(b){alert("服务器遇到了未知的错误，或者也可能是您浏览器版本太老。建议您升级您的浏览器")}},c.send(d)}}var k,id,a,starttime;show.render.lasttime=document.getElementById("lasttime"),show.render.topiclist=document.getElementById("topiclist"),show.render.flag=document.getElementById("flag"),show.render.submit=document.getElementById("submit");for(k in topic.ids)topic.ids[k]&&"number"==typeof topic.ids[k]&&(id=topic.ids[k],a=document.createElement("A"),a.setAttribute("data-id",id),a.href="javascript:topic.Q("+id+")",show.setText(a,1+parseInt(k)),show.render.topiclist.appendChild(a));!function(){var a=document.createElement("span");a.className="clear",show.render.topiclist.appendChild(a)}(),show.setResult=function(){var a=topic.getAnswer(show.data.type,show.data.selected);a&&(show.setText(show.render.result,a),message.setMousePoint(document.getElementById("exam")),message.pointData.x<200&&(message.pointData.x=document.getElementById("exam").offsetLeft+120),message.pointData.y<60&&(message.pointData.y+=70),message.pointData.y+=50,message.show('您刚刚选择了&nbsp;&nbsp;<strong style="color:green;">'+a+"</strong>",1e3))},topic.usetime=0,topic.stop=!1,show.setTime=function(){var a,b,c;show.timeout||topic.stop||(topic.usetime++,a=60*topic.time,a=parseInt(a-topic.usetime),b="",c="",b=Math.floor(a/60),c=Math.floor(a%60),10>b&&(b="0"+b),10>c&&(c="0"+c),show.setText(show.render.lasttime,b+":"+c),300==a&&message.show('离考试结束还有<b style="color:red;">5</b>分钟，请抓紧时间！',3e4),0>=a&&(message.show("考试时间到了，系统将自动交卷！",1e4),show.timeout=!0,show.render.submit.click()),setTimeout(show.setTime,999))},topic.Q=function(a){show.getItem(a);var b="select";"number"==typeof topic.currentid&&show.removeClass(b,show.getItem(topic.currentid)),show.removeClass("error",show.getItem(a)),show.addClass(b,show.getItem(a)),this.getQuestion(a)},show.render.flag.onclick=function(){var a=show.getItem(show.data.id),b="flag";-1===a.className.indexOf(b)?show.addClass(b,a):show.removeClass(b,a)},show.render.submit.onclick=function(a){var b,c,d;a=a||window.event,b=new _submit,!show.timeout&&(c=b.checkNone(),c.none>1&&(msg="您还有 "+c.none+" /"+c.all+"道题没做, 确定交卷吗?",!confirm(msg)))||(d=b.getValue(),message.show("正在向服务器传送数据，请稍等 ..."),b.send(d))},starttime=new Date,topic.start(),show.setTime();